{% extends "base.html" %}
{% block title %}HR Dashboard{% endblock %}
{% block Addnav %}
<li class="nav-item active">
  <a class="nav-link" style="color: #f39c12;" href="/HR1/post_job">Post JOB</a>
</li>
{% endblock %}

{% block content %}
<script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
<script>
  var $j = jQuery.noConflict();
</script>

<style>
  /* Dark Mode Styles */
  .container-fluid,
  .container,
  .modal-content {
    background-color: #2c3e50;
    color: #ecf0f1;
  }

  .form-control,
  .form-control-plaintext,
  .btn {
    background-color: #34495e;
    color: #ecf0f1;
    border: 1px solid #f39c12;
  }

  .table {
    background-color: #34495e;
    color: #ecf0f1;
  }

  .table-bordered th,
  .table-bordered td {
    border-color: #f39c12;
  }

  .btn-secondary,
  .btn-danger {
    background-color: #f39c12;
    border: none;
    color: #2c3e50;
  }

  /* Responsive Styles */
  @media screen and (max-width: 560px) {
    #categoryInput {
      width: 100%;
    }

    input.sBto {
      width: 100%;
      height: 20%;
      margin-bottom: 20px;
    }
  }

  @media screen and (min-width: 560px) {
    input.sBto {
      width: 60%;
      margin-left: 20%;
      height: 30%;
      margin-bottom: 50px;
    }
  }
</style>

<div class="contain-fluid">
  <div class="container">
    <div class="row">
      <h2>{{ errorMsg }}</h2>

      <div class="col-xs-12">
        <form class="form-horizontal" action="/empSearch" method="POST">
          <div class="form-floating mb-3 categoryInput1">
            <input type="text" name="category" id="categoryInput" class="form-control"
              style="background-color: #34495e; color: #ecf0f1;" />
            <label for="categoryInput" style="color: #ecf0f1;">Enter Job Title:</label>
          </div>
          <div class="form-group">
            <input type="submit" class="btn btn-danger sBto" name="submit" value="Search" />
          </div>
        </form>
      </div>
    </div>

    <div class="row">
      <div class="col-xs-12 table-responsive-sm">
        <table class="table table-bordered">
          <thead>
            <tr>
              <th class="text-center">No</th>
              <th class="text-center">Name</th>
              <th class="text-center">Email</th>
              <th class="text-center">Details</th>
            </tr>
          </thead>
          <tbody>
            {% for i in range(0, data|length) %}
            <tr>
              <td class="text-center">{{ i + 1 }}</td>
              <td class="text-center">{{ data[i]['Name'] }}</td>
              <td class="text-center">{{ data[i]['Email'] }}</td>
              <td>
                <input type="button" name="view" value="View" id="{{ data[i]['_id'] }}" data-bs-toggle="modal"
                  data-bs-target="#viewdetails" class="btn btn-secondary view_data" style="margin-left: 10%" />
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<div class="modal fade" id="viewdetails" tabindex="-1" role="dialog" aria-labelledby="viewdetails" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-fullscreen-sm-down" role="document">
    <div class="modal-content" style="background-color: #34495e; color: #ecf0f1;">
      <div class="modal-header">
        <h3 class="modal-title" id="exampleModalLongTitle">
          Details of Candidate:
        </h3>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <table class="table table-responsive">
          <br />
          <tr>
            <label>Name:</label>
            <input type="text" class="form-control-plaintext" readonly id="view_name"
              style="background-color: #34495e; color: #ecf0f1;" />
          </tr>
          <br />
          <tr>
            <label>LinkedIn Link:</label>
            <input type="text" class="form-control-plaintext" readonly id="view_linkedin_link"
              style="background-color: #34495e; color: #ecf0f1;" />
          </tr>
          <br />
          <tr>
            <label>Skills:</label>
            <input type="text" class="form-control-plaintext" readonly id="view_skills"
              style="background-color: #34495e; color: #ecf0f1;" />
          </tr>

          <br />
          <tr>
            <label>Certification:</label>
            <input type="text" class="form-control-plaintext" readonly id="view_certificates"
              style="background-color: #34495e; color: #ecf0f1;" />
          </tr>

          <br />
        </table>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" aria-label="Close"
          style="background-color: #f39c12; color: #2c3e50;">
          Close
        </button>
      </div>
    </div>
  </div>
</div>

<script>
  $(document).on("click", ".view_data", function () {
    var employee_id = $(this).attr("id");
    $j.ajax({
      url: "/viewdetails",
      method: "POST",
      data: { employee_id: employee_id },
      success: function (data) {
        $("#view_name").val(data.name);
        $("#view_linkedin_link").val(data.linkedin_link);
        $("#view_skills").val(data.skills);
        $("#view_certificates").val(data.certificate);
      },
    });
  });
</script>

{% endblock %}